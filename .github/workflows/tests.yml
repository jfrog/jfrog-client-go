name: JFrog Client Go Tests
on: [push]
jobs:
  JFrog-Client-Go-Tests:
    name: ${{ matrix.product }} (${{ matrix.os }})
    strategy:
      fail-fast: false
      max-parallel: 1
      matrix:
        product: [artifactory, distribution, xray, pipelines, access]
        os: [ubuntu-latest, macos-latest, windows-latest]
    runs-on: ${{ matrix.os }}
    steps:
    - name: Install Go
      uses: actions/setup-go@v2
      with:
        go-version: 1.17.x
    - name: Checkout code
      uses: actions/checkout@v2
    - name: Lint
      run: go vet -v ./...
    - name: ${{ matrix.product }}-Tests
      run: go test -v github.com/jfrog/jfrog-client-go/tests --timeout 0 --test.${{ matrix.product }}=true --rt.url=${{ secrets.CLI_RT_URL }} --ds.url=${{ secrets.CLI_DIST_URL }} --xr.url=${{ secrets.CLI_XRAY_URL }} --pipe.url=${{ secrets.CLI_PIPE_URL }} --access.url=${{ secrets.CLI_ACCESS_URL }} --rt.user=${{ secrets.CLI_RT_USER }} --rt.password=${{ secrets.CLI_RT_PASSWORD }} --pipe.accessToken=${{ secrets.CLI_PIPE_ACCESS_TOKE }} --pipe.vcsToken=${{ secrets.CLI_PIPE_VCS_TOKEN }} --pipe.vcsRepo=${{ secrets.CLI_PIPE_VCS_REPO }} --pipe.vcsBranch=${{ secrets.CLI_PIPE_VCS_BRANCH }} --access.token=${{ secrets.CLI_ACCESS_TOKEN }}